{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nasync function getImagesByQuery(query, page = 1) {\n  try {\n    const response = await axios\n    .get(\"/\", {\n      params: {\n        key: \"53422022-80b0b4b31a05bf5340553aea2\",\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n        page: page,\n        per_page: 15,\n      },\n    })\n    return response.data;\n  } catch (error) {\n    console.error(error);\n    throw error;\n  }\n}\n\nexport default getImagesByQuery;\n","// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nconst gallery = document.querySelector('.gallery');\nlet lightbox = null;\n\nfunction createGallery(images) {\n  const galleryMarkup = images\n  .map(\n    ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n      `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n            />\n        </a>\n        <ul class=\"image-stats\">\n          <li class=\"stats-item\">\n            <p class=\"stat-title\">Likes</p>\n            <p class=\"stat-value\">${likes}</p>\n          </li>\n          <li class=\"stats-item\">\n            <p class=\"stat-title\">Views</p>\n            <p class=\"stat-value\">${views}</p>\n          </li>\n          <li class=\"stats-item\">\n            <p class=\"stat-title\">Comments</p>\n            <p class=\"stat-value\">${comments}</p>\n          </li>\n          <li class=\"stats-item\">\n            <p class=\"stat-title\">Downloads</p>\n            <p class=\"stat-value\">${downloads}</p>\n          </li>\n        </ul>\n    </li>`\n  )\n  .join('');\n\n  gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  }\n};\n\nfunction clearGallery() {\n  const gallery = document.querySelector(\".gallery\");\n  gallery.innerHTML = \"\";\n  gallery.classList.add(\"hidden\");\n};\n\n\nfunction showLoader() {\n  document.getElementById(\"loader\").classList.remove(\"hidden\");\n};\n\nfunction hideLoader() {\n  document.getElementById(\"loader\").classList.add(\"hidden\");\n};\n\nfunction showLoadMoreButton() {\n  document.getElementById(\"load-more\").classList.remove(\"hidden\");\n}\n\n\nfunction hideLoadMoreButton() {\n  document.getElementById(\"load-more\").classList.add(\"hidden\");\n}\n\nexport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton };","// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport getImagesByQuery from \"./js/pixabay-api\"\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from \"./js/render-functions\"\n\n\nconst form = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loadMore = document.getElementById(\"load-more\");\n\nlet query = undefined;\nlet pageToLoad = 1;\nconst perPageElemLimit = 15;\nlet images = [];\nlet totalPages = 0;\n\nasync function waitForImagesToLoad() {\n  const imgs = document.querySelectorAll(\".gallery-image\");\n\n  const promises = Array.from(imgs).map(img => {\n    return new Promise(resolve => {\n      if (img.complete) {\n        resolve();\n      } else {\n        img.addEventListener(\"load\", resolve, { once: true });\n        img.addEventListener(\"error\", resolve, { once: true });\n      }\n    });\n  });\n\n  await Promise.all(promises);\n}\n\nfunction smoothScroll() {\n  const firstCard = document.querySelector('.gallery-item');\n  if (!firstCard) return;\n\n  const cardHeight = firstCard.getBoundingClientRect().height;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth'\n  });\n}\n\nconst handleFormSubmit = async event => {\n  event.preventDefault();\n  gallery.innerHTML = \"\";\n  pageToLoad = 1;\n  hideLoadMoreButton();\n  clearGallery();\n  showLoader();\n\n  query = form.elements[\"search-text\"].value.trim();\n\n  try {\n    const data = await getImagesByQuery(query, pageToLoad);\n\n    images = data.hits;\n    totalPages = Math.ceil(data.totalHits / perPageElemLimit);\n\n    if (!images || images.length === 0) {\n      throw new Error(\"No images found\");\n    }\n    createGallery(images);\n    await waitForImagesToLoad();\n    gallery.classList.remove(\"hidden\");\n\n    if (pageToLoad < totalPages) {\n      showLoadMoreButton();\n    }\n  } catch (err) {\n    iziToast.error({\n      message: \"Sorry, there are no images matching your search query. Please try again!\",\n      position: \"topRight\",\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nform.addEventListener(\"submit\", handleFormSubmit)\n\nconst handleLoadMoreClick = async event => {\n  event.preventDefault();\n  pageToLoad += 1;\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, pageToLoad);\n\n    const images = data.hits;\n\n    if (!images || images.length === 0 || pageToLoad >= totalPages) {\n      throw new Error(\"No images found\");\n    }\n\n    createGallery(images);\n    await waitForImagesToLoad();\n    smoothScroll();\n    hideLoader();\n\n  } catch (error) {\n    hideLoader();\n    iziToast.error({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: \"topRight\",\n    });\n    hideLoadMoreButton();\n  }\n}\n\nloadMore.addEventListener(\"click\", handleLoadMoreClick);"],"names":["axios","getImagesByQuery","query","page","error","gallery","lightbox","createGallery","images","galleryMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","loadMore","pageToLoad","perPageElemLimit","totalPages","waitForImagesToLoad","imgs","promises","img","resolve","smoothScroll","firstCard","cardHeight","handleFormSubmit","event","data","iziToast","handleLoadMoreClick"],"mappings":"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"}